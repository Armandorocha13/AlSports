(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6633:function(e,r,t){Promise.resolve().then(t.t.bind(t,7960,23)),Promise.resolve().then(t.bind(t,4279)),Promise.resolve().then(t.bind(t,6281)),Promise.resolve().then(t.bind(t,7527)),Promise.resolve().then(t.t.bind(t,2972,23)),Promise.resolve().then(t.t.bind(t,5109,23))},4279:function(e,r,t){"use strict";t.d(r,{default:function(){return g}});var a=t(7437),s=t(2265),l=t(7648),i=t(3145),o=t(3247),n=t(6275),c=t(2369),d=t(8906),u=t(7692),m=t(2489);let h=(0,t(9763).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var x=t(7882),f=t(6281),p=t(7527);function g(){let[e,r]=(0,s.useState)(!1),[t,g]=(0,s.useState)(!1),[y,v]=(0,s.useState)(!1),{user:b,profile:j,signOut:N}=(0,f.a)(),{getTotalItems:_,getTotal:k,getShippingInfo:w}=(0,p.j)();return(0,a.jsxs)("header",{className:"bg-gray-900 shadow-lg sticky top-0 z-50 border-b border-gray-800",children:[(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.default,{href:"/",className:"flex items-center",children:(0,a.jsx)("div",{className:"w-24 h-16 flex items-center justify-center",children:(0,a.jsx)(i.default,{src:"/images/Logo/Monograma2.png",alt:"AlSports Logo",width:200,height:160,className:"object-contain",priority:!0})})}),(0,a.jsx)("nav",{className:"hidden lg:flex items-center space-x-8",children:x.bd.map(e=>(0,a.jsx)(l.default,{href:"/categoria/".concat(e.slug),className:"text-gray-300 hover:text-primary-400 font-medium text-sm transition-colors duration-200",children:e.name},e.id))}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>g(!t),className:"p-2 text-gray-400 hover:text-primary-400 transition-colors duration-200",children:(0,a.jsx)(o.Z,{size:20})}),(0,a.jsxs)("a",{href:"/carrinho",className:"relative p-2 text-gray-400 hover:text-primary-400 transition-colors duration-200 group",title:"Carrinho: ".concat(_()," item(s) - R$ ").concat(k().toFixed(2)),children:[(0,a.jsx)(n.Z,{size:20}),_()>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary-500 text-black text-xs rounded-full h-5 w-5 flex items-center justify-center font-semibold animate-pulse",children:_()}),(0,a.jsx)("div",{className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50",children:(0,a.jsxs)("div",{className:"p-3 space-y-1",children:[(0,a.jsx)("div",{className:"font-semibold text-primary-400",children:"Carrinho"}),(0,a.jsxs)("div",{className:"text-gray-300",children:[_()," item(s) no carrinho"]}),(0,a.jsxs)("div",{className:"text-gray-300",children:["Total: R$ ",k().toFixed(2)]}),(0,a.jsx)("div",{className:"text-gray-400 text-xs",children:"transportadora"===w().method?"\uD83D\uDE9B Transportadora":"\uD83D\uDCE6 Super Frete"})]})})]})]}),b?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>v(!y),className:"flex items-center space-x-2 p-2 text-gray-400 hover:text-primary-400 transition-colors duration-200",children:[(0,a.jsx)(c.Z,{size:20}),(0,a.jsx)("span",{className:"hidden md:block text-sm",children:(null==j?void 0:j.full_name)||b.email})]}),y&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50",children:[(0,a.jsx)(l.default,{href:"/minha-conta",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>v(!1),children:"Minha Conta"}),(0,a.jsx)(l.default,{href:"/minha-conta/pedidos",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>v(!1),children:"Meus Pedidos"}),(0,a.jsx)(l.default,{href:"/minha-conta/enderecos",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>v(!1),children:"Endere\xe7os"}),(null==j?void 0:j.user_type)==="admin"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-1"}),(0,a.jsx)(l.default,{href:"/admin",className:"block px-4 py-2 text-sm text-white bg-primary-500 hover:bg-primary-600 font-medium",onClick:()=>v(!1),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Painel Admin"]})})]}),(0,a.jsx)("hr",{className:"my-1"}),(0,a.jsxs)("button",{onClick:()=>{N(),v(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,a.jsx)(u.Z,{size:16,className:"inline mr-2"}),"Sair"]})]})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l.default,{href:"/auth/login",className:"text-gray-400 hover:text-primary-400 transition-colors duration-200 text-sm",children:"Entrar"}),(0,a.jsx)("span",{className:"text-gray-600",children:"|"}),(0,a.jsx)(l.default,{href:"/auth/register",className:"text-gray-400 hover:text-primary-400 transition-colors duration-200 text-sm",children:"Cadastrar"})]}),(0,a.jsx)("button",{onClick:()=>r(!e),className:"lg:hidden p-2 text-gray-400 hover:text-primary-400 transition-colors duration-200",children:e?(0,a.jsx)(m.Z,{size:24}):(0,a.jsx)(h,{size:24})})]})]}),t&&(0,a.jsx)("div",{className:"mt-4 pb-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar produtos...",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 text-white rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent placeholder-gray-400"}),(0,a.jsx)(o.Z,{className:"absolute right-3 top-2.5 text-gray-400",size:20})]})})]}),e&&(0,a.jsx)("div",{className:"lg:hidden bg-gray-800 border-t border-gray-700",children:(0,a.jsx)("nav",{className:"container mx-auto px-4 py-4",children:(0,a.jsx)("div",{className:"space-y-2",children:x.bd.map(e=>(0,a.jsx)(l.default,{href:"/categoria/".concat(e.slug),className:"block py-2 text-gray-300 hover:text-primary-400 font-medium text-sm transition-colors duration-200",onClick:()=>r(!1),children:e.name},e.id))})})}),_()>0&&(0,a.jsx)("div",{className:"fixed bottom-6 right-6 z-40 lg:hidden",children:(0,a.jsxs)("a",{href:"/carrinho",className:"bg-primary-500 hover:bg-primary-400 text-black p-4 rounded-full shadow-lg transition-all duration-200 transform hover:scale-105 block",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(n.Z,{size:24}),(0,a.jsx)("span",{className:"text-xs font-semibold mt-1",children:_()})]}),(0,a.jsx)("div",{className:"absolute inset-0 bg-primary-500 rounded-full animate-ping opacity-20"})]})})]})}},6281:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return o},a:function(){return n}});var a=t(7437),s=t(2265),l=t(9203);let i=(0,s.createContext)(void 0);function o(e){let{children:r}=e,[t,o]=(0,s.useState)(null),[n,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0),x=(0,l.e)();(0,s.useEffect)(()=>{(async()=>{var e;let{data:{session:r}}=await x.auth.getSession();u(r),o(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),(null==r?void 0:r.user)&&await f(r.user.id),h(!1)})();let{data:{subscription:e}}=x.auth.onAuthStateChange(async(e,r)=>{var t;u(r),o(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),(null==r?void 0:r.user)?await f(r.user.id):c(null),h(!1)});return()=>e.unsubscribe()},[]);let f=async e=>{try{let{data:r,error:a}=await x.from("profiles").select("*").eq("id",e).single();if(a){console.error("Erro ao buscar perfil:",a),console.log("Tentando criar perfil para usu\xe1rio:",e);let{data:r,error:s}=await x.from("profiles").insert({id:e,email:(null==t?void 0:t.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",user_type:"cliente"}).select().single();if(s){console.error("Erro ao criar perfil:",s);let r={id:e,email:(null==t?void 0:t.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c(r)}else console.log("Perfil criado com sucesso:",r),c(r)}else console.log("Perfil encontrado:",r),c(r);let{data:s,error:l}=await x.from("user_roles").select("role").eq("user_id",e);if(l){console.error("Erro ao buscar roles:",l),c(r);return}let i=r.user_type||"cliente";if(s&&s.length>0){let e=s.map(e=>e.role);e.includes("admin")?i="admin":e.includes("vendedor")&&(i="vendedor")}"00000000-0000-0000-0000-000000000001"===e&&(i="admin",console.log("\uD83D\uDD27 Usu\xe1rio admin detectado via fallback"));let o={...r,user_type:i};c(o)}catch(r){console.error("Erro ao buscar perfil:",r),c({id:e,email:"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}},p=async(e,r,t)=>{try{let{data:a}=await x.auth.getUser(),{data:s}=await x.from("profiles").select("email").eq("email",e).single();if(s)return{error:{message:"Este email j\xe1 est\xe1 cadastrado"}};if(t.cpf){let{data:e}=await x.from("profiles").select("cpf").eq("cpf",t.cpf).single();if(e)return{error:{message:"Este CPF j\xe1 est\xe1 cadastrado"}}}console.log("Criando usu\xe1rio no Supabase Auth...");let{data:l,error:i}=await x.auth.signUp({email:e,password:r,options:{data:{full_name:t.full_name,phone:t.phone}}});if(console.log("Resultado da cria\xe7\xe3o do usu\xe1rio:",{data:l,error:i}),i){let e=i.message;return i.message.includes("already registered")||i.message.includes("User already registered")?e="Este email j\xe1 est\xe1 cadastrado":i.message.includes("Invalid email")?e="Email inv\xe1lido":i.message.includes("Password should be at least")?e="A senha deve ter pelo menos 6 caracteres":i.message.includes("Unable to validate email address")&&(e="N\xe3o foi poss\xedvel validar o email"),{error:{...i,message:e}}}if(l.user){console.log("Criando perfil para usu\xe1rio:",l.user.id),console.log("Dados do perfil:",{id:l.user.id,email:l.user.email,full_name:t.full_name,phone:t.phone,cpf:t.cpf,birth_date:t.birth_date,user_type:"cliente"});let{data:e,error:r}=await x.from("profiles").insert({id:l.user.id,email:l.user.email,full_name:t.full_name,phone:t.phone,cpf:t.cpf,birth_date:t.birth_date,user_type:"cliente"}).select();if(r)return console.error("Erro ao criar perfil:",r),console.error("Detalhes do erro:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),await x.auth.admin.deleteUser(l.user.id),{error:{message:"Erro ao criar perfil do usu\xe1rio"}};console.log("Perfil criado com sucesso:",e)}return console.log("Cadastro finalizado com sucesso, retornando sucesso"),{error:null}}catch(e){return console.error("Erro no signUp:",e),{error:{message:"Erro interno do servidor"}}}},g=async(e,r)=>{try{var t;console.log("Tentando fazer login para:",e);let{data:a,error:s}=await x.auth.signInWithPassword({email:e,password:r});if(s)return console.error("Erro no login:",s),{error:s};return console.log("Login realizado com sucesso:",null===(t=a.user)||void 0===t?void 0:t.email),{error:null}}catch(e){return console.error("Erro no catch do login:",e),{error:e}}},y=async()=>{try{await x.auth.signOut()}catch(e){console.error("Erro ao fazer logout:",e)}},v=async e=>{if(!t)return{error:Error("Usu\xe1rio n\xe3o autenticado")};try{let{error:r}=await x.from("profiles").update(e).eq("id",t.id);if(r)return{error:r};return c(r=>r?{...r,...e}:null),{error:null}}catch(e){return{error:e}}};return(0,a.jsx)(i.Provider,{value:{user:t,profile:n,session:d,loading:m,signUp:p,signIn:g,signOut:y,updateProfile:v},children:r})}function n(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}},7692:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},3247:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8906:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},6275:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},2369:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2489:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7960:function(){},5109:function(e){e.exports={style:{fontFamily:"'__Montserrat_434d9e', '__Montserrat_Fallback_434d9e'",fontStyle:"normal"},className:"__className_434d9e",variable:"__variable_434d9e"}}},function(e){e.O(0,[489,972,99,726,882,527,971,117,744],function(){return e(e.s=6633)}),_N_E=e.O()}]);