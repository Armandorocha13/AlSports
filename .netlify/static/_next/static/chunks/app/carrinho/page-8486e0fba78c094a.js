(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[521],{78:function(e,t,a){Promise.resolve().then(a.bind(a,7596))},7596:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var r=a(7437),s=a(2265),i=a(9376),l=a(2660),n=a(6275),o=a(8930),c=a(9763);let d=(0,c.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var u=a(9397),m=a(2718),h=a(7527),p=a(6281);a(7882);var x=a(340);let g=(0,c.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var f=a(4794),y=a(1723);class v{async calculateShipping(e,t){try{console.log("\uD83D\uDE9A Tentando calcular frete via SuperFrete...");let a=e.from.postal_code,r=e.to.postal_code,s=e.products[0];console.log("\uD83D\uDCE6 Dados do produto:",s);let i=this.calculateDistance(a,r),l=this.calculateBasePrice(i,s.weight),n=[{id:"1",name:"PAC",price:l,delivery_time:Math.max(3,Math.ceil(i/200)),delivery_range:{min:Math.max(3,Math.ceil(i/200)),max:Math.max(5,Math.ceil(i/150))},company:{id:1,name:"Correios",picture:""}},{id:"2",name:"SEDEX",price:Math.round(1.5*l),delivery_time:Math.max(1,Math.ceil(i/300)),delivery_range:{min:Math.max(1,Math.ceil(i/300)),max:Math.max(2,Math.ceil(i/250))},company:{id:2,name:"Correios",picture:""}}];return(t?t.reduce((e,t)=>e+t.quantity,0):0)>=20&&n.push({id:"3",name:"Jadlog",price:Math.round(.8*l),delivery_time:Math.max(2,Math.ceil(i/250)),delivery_range:{min:Math.max(2,Math.ceil(i/250)),max:Math.max(4,Math.ceil(i/200))},company:{id:3,name:"Jadlog",picture:""}},{id:"4",name:"Total Express",price:Math.round(.9*l),delivery_time:Math.max(2,Math.ceil(i/280)),delivery_range:{min:Math.max(2,Math.ceil(i/280)),max:Math.max(4,Math.ceil(i/220))},company:{id:4,name:"Total Express",picture:""}},{id:"5",name:"Loggi",price:Math.round(1.2*l),delivery_time:Math.max(1,Math.ceil(i/400)),delivery_range:{min:Math.max(1,Math.ceil(i/400)),max:Math.max(2,Math.ceil(i/300))},company:{id:5,name:"Loggi",picture:""}}),console.log("✅ Pre\xe7os calculados baseados na dist\xe2ncia:",n),n}catch(e){throw console.error("❌ Erro ao calcular frete:",e),e}}calculateDistance(e,t){let a=parseInt(e.substring(0,2)),r=parseInt(t.substring(0,2));return a===r?50:2>=Math.abs(a-r)?200:5>=Math.abs(a-r)?500:1e3}calculateBasePrice(e,t){return Math.max(8,Math.min(50,8+2*Math.ceil(e/100)+3*Math.ceil(t)))}async getShippingOptions(e,t,a){let r=a.reduce((e,t)=>e+t.weight*t.quantity,0),s=a.reduce((e,t)=>e+t.value*t.quantity,0),i=Math.max(...a.map(e=>e.width)),l=Math.max(...a.map(e=>e.height)),n=Math.max(...a.map(e=>e.length)),o={from:{postal_code:e.replace(/\D/g,"")},to:{postal_code:t.replace(/\D/g,"")},products:[{id:"package",width:i,height:l,length:n,weight:r,insurance_value:s,quantity:1}],services:["1","2","3","4","5"]};try{let e=(await this.calculateShipping(o,a)).filter(e=>e&&e.price>0&&!e.error).map(e=>({id:e.id,name:e.name,price:e.price,delivery_time:e.delivery_time,company:e.company})).sort((e,t)=>e.price-t.price);return console.log("\uD83D\uDE9A Op\xe7\xf5es v\xe1lidas do SuperFrete:",e),e.sort((e,t)=>e.price-t.price)}catch(e){throw console.error("❌ Erro na API SuperFrete:",e),e}}constructor(e){this.baseUrl="https://api.superfrete.com",this.apiKey=e}}let b=new v("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE3NjA5ODUyNDIsInN1YiI6IlBIc0VYRTh4ckNZdE1QUUlWcXdmSGZXSmNBbzIifQ.Csmlr1Iyx61wqru_p7GYaejS-LNPxEwp6FPG92P4Wak");function j(e){let{products:t,totalPieces:a=0,onShippingSelect:i}=e,[l,n]=(0,s.useState)(""),{shippingOptions:o,loading:c,error:d,selectedOption:u,setSelectedOption:m}=function(e){let{fromCep:t,toCep:a,products:r,totalPieces:i=0}=e,[l,n]=(0,s.useState)([]),[o,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),p=async()=>{if(!t||!a||0===r.length){n([]);return}c(!0),u(null);try{console.log("\uD83D\uDE9A Calculando frete...",{fromCep:t,toCep:a,products:r});let e=r.map(e=>({...function(e){let t={futebol:{width:30,height:2,length:40,weight:.3},nba:{width:30,height:2,length:40,weight:.3},nfl:{width:30,height:2,length:40,weight:.3},"roupas-treino":{width:25,height:2,length:35,weight:.2},"conjuntos-infantis":{width:20,height:2,length:30,weight:.15},acessorios:{width:15,height:2,length:20,weight:.1},"bermudas-shorts":{width:25,height:2,length:35,weight:.2}};return t[e]||t.futebol}(e.category),value:e.value,quantity:e.quantity}));console.log("\uD83D\uDCE6 Dimens\xf5es dos produtos:",e);let s=await b.getShippingOptions(t,a,e);if(console.log("✅ Op\xe7\xf5es de frete recebidas:",s),n(s),s.length>0){let e=s.reduce((e,t)=>e.price<t.price?e:t);h(e),console.log("\uD83C\uDFAF Op\xe7\xe3o selecionada:",e)}}catch(s){console.error("❌ Erro ao calcular frete:",s);let e="Erro ao calcular frete";s instanceof Error&&(e=s.message.includes("Failed to fetch")?"N\xe3o foi poss\xedvel conectar com a API de frete":s.message.includes("Network")?"Problema de conex\xe3o com a internet":s.message),u(e);let r=function(e,t,a){let r=t.substring(0,2),s=e.substring(0,2),i=15,l=5;r===s?(i=8,l=3):["01","02","03","04","05","06","07","08","09"].includes(r)?(i=12,l=4):["10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"].includes(r)?(i=18,l=6):["30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49"].includes(r)?(i=16,l=5):["50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69"].includes(r)?(i=20,l=7):["70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89"].includes(r)?(i=25,l=8):(i=15,l=5);let n=[{id:"pac-fallback",name:"PAC",price:i,delivery_time:l,company:{id:1,name:"Correios",picture:""}},{id:"sedex-fallback",name:"SEDEX",price:Math.round(1.5*i),delivery_time:Math.max(2,l-2),company:{id:2,name:"Correios",picture:""}}];return a>=20&&(n.push({id:"jadlog-fallback",name:"Jadlog (20+ pe\xe7as)",price:Math.round(.7*i),delivery_time:Math.max(3,l-1),company:{id:3,name:"Jadlog",picture:""}}),n.push({id:"total-express-fallback",name:"Total Express (20+ pe\xe7as)",price:Math.round(.8*i),delivery_time:Math.max(2,l-2),company:{id:4,name:"Total Express",picture:""}}),n.push({id:"loggi-fallback",name:"Loggi (20+ pe\xe7as)",price:Math.round(1.1*i),delivery_time:Math.max(1,l-3),company:{id:5,name:"Loggi",picture:""}})),n.sort((e,t)=>e.price-t.price)}(t,a,i);n(r),r.length>0&&h(r[0])}finally{c(!1)}};return(0,s.useEffect)(()=>{p()},[t,a,r]),{shippingOptions:l,loading:o,error:d,selectedOption:m,setSelectedOption:h,recalculate:p}}({fromCep:"26015-005",toCep:l,products:t,totalPieces:a}),h=e=>{m(e),null==i||i(e)},p=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),v=e=>1===e?"1 dia \xfatil":"".concat(e," dias \xfateis");return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[(0,r.jsx)(x.Z,{className:"w-5 h-5 text-primary-400"}),"Calcular Frete"]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"CEP de Destino"}),(0,r.jsx)("input",{type:"text",placeholder:"00000-000",value:l,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Enviando de Nova Igua\xe7u - RJ (26015-005)"})]})}),c&&(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-400"}),(0,r.jsx)("span",{className:"ml-2 text-gray-400",children:"Calculando frete..."})]}),d&&(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-400",children:[(0,r.jsx)(g,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"Erro ao calcular frete"})]}),(0,r.jsx)("p",{className:"text-red-300 text-sm mt-1",children:d})]}),o.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"text-md font-medium text-white mb-3",children:"Op\xe7\xf5es de Frete:"}),a<20&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-3 mb-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs font-bold",children:"!"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-red-400",children:"\uD83D\uDE9A Transportadoras Privadas"}),(0,r.jsxs)("p",{className:"text-xs text-red-300 mt-1",children:[(0,r.jsx)("strong",{children:"Jadlog, Total Express e Loggi"})," aparecem apenas para pedidos com ",(0,r.jsx)("strong",{children:"20 pe\xe7as ou mais"}),".",(0,r.jsx)("br",{}),(0,r.jsxs)("span",{className:"text-gray-400",children:["Atual: ",a," pe\xe7as no carrinho"]})]})]})]})}),o.map(e=>(0,r.jsx)("div",{className:"border rounded-lg p-4 cursor-pointer transition-all duration-200 ".concat((null==u?void 0:u.id)===e.id?"border-primary-500 bg-primary-500/10":"border-gray-600 hover:border-gray-500"),onClick:()=>h(e),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center",children:(0,r.jsx)(f.Z,{className:"w-5 h-5 text-primary-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-medium text-white",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:e.company.name})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-lg font-bold text-primary-400",children:p(e.price)}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-400",children:[(0,r.jsx)(y.Z,{className:"w-4 h-4"}),v(e.delivery_time)]})]})]})},e.id))]}),u&&(0,r.jsx)("div",{className:"mt-4 p-4 bg-primary-500/10 border border-primary-500/30 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-medium text-white",children:"Frete Selecionado"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:u.name})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-lg font-bold text-primary-400",children:p(u.price)}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:v(u.delivery_time)})]})]})})]})}function N(){let e=(0,i.useRouter)(),{user:t}=(0,p.a)(),{items:a,addItem:c,removeItem:x,updateQuantity:g,getTotalItems:f,getTotalPieces:y,getSubtotal:v,getTotal:b,getItemPrice:N,getShippingInfo:w,getShippingCost:C,canUseTransportadora:E,getMissingForTransportadora:M,createOrder:k,clearCart:S,openWhatsAppOrder:D,saveOrderToDatabase:_,getDiscountSummary:P,getItemDiscount:A,getNextDiscountThreshold:R}=(0,h.j)(),[I,F]=(0,s.useState)(!1),[T,Z]=(0,s.useState)([]),[q,z]=(0,s.useState)(!0),[O,U]=(0,s.useState)(""),[G,$]=(0,s.useState)(0),[J,B]=(0,s.useState)(""),[L,V]=(0,s.useState)(!1),[W,H]=(0,s.useState)([]),[X,Y]=(0,s.useState)(null);w(),P();let Q=()=>X?X.price:C(),K=()=>{let e=v()+Q();return"FREEGRATIS"===J?e=v():G>0&&(e*=1-G/100),e},ee=()=>a.reduce((e,t)=>e+t.product.price*t.quantity,0)-v()+("FREEGRATIS"===J?C():G>0?b()*(G/100):0),et=async()=>{if(!t){e.push("/auth/login?redirectTo=/carrinho");return}F(!0);try{var a,r;let s={name:(null===(a=t.user_metadata)||void 0===a?void 0:a.full_name)||"Cliente",email:t.email||"",phone:(null===(r=t.user_metadata)||void 0===r?void 0:r.phone)||""};console.log("\uD83D\uDC64 Dados do cliente:",s);let i=k(s,void 0,"WhatsApp","Pedido finalizado via WhatsApp");console.log("\uD83D\uDCE6 Pedido criado:",i),console.log("\uD83D\uDCBE Salvando pedido...");let l=await _(s,i);console.log("✅ Pedido salvo:",l),alert("\uD83C\uDF89 Pedido Criado! Seu n\xfamero de pedido \xe9: *".concat(i.code,"*\n\n")+'\uD83D\uDCDD *INSTRU\xc7\xd5ES IMPORTANTES:*\n• Anote o n\xfamero do pedido.\n• Envie o comprovante de pagamento junto com este n\xfamero via WhatsApp.\n• Aguarde a confirma\xe7\xe3o do pagamento.\n\n✅ *Pedido salvo! Voc\xea pode acompanhar na aba "Meus Pedidos".*');let n="https://wa.me/".concat("5521990708854","?text=").concat(encodeURIComponent("Ol\xe1! Tenho um novo pedido para voc\xea:\n\n"+"*N\xfamero do Pedido:* ".concat(i.code,"\n")+"*Total:* R$ ".concat(K().toFixed(2),"\n")+"*Itens:*\n".concat(i.items.map(e=>"- ".concat(e.quantity,"x ").concat(e.productName," (").concat(e.size,") - R$ ").concat(e.totalPrice.toFixed(2))).join("\n"),"\n\n")+"Por favor, aguardo as instru\xe7\xf5es para pagamento e envio do comprovante."));window.open(n,"_blank"),S(),e.push("/minha-conta/pedidos")}catch(e){console.error("Erro ao finalizar pedido:",e),alert("Ocorreu um erro ao finalizar seu pedido. Por favor, tente novamente.")}finally{F(!1)}};return 0===a.length?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,r.jsx)("div",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center text-gray-300 hover:text-white",children:[(0,r.jsx)(l.Z,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("span",{className:"font-medium",children:"Carrinho"})]}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"0 itens"})]})}),(0,r.jsxs)("div",{className:"bg-gray-800 p-12 text-center",children:[(0,r.jsx)(n.Z,{size:64,className:"h-24 w-24 text-gray-400 mx-auto mb-6"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Seu carrinho est\xe1 vazio"}),(0,r.jsx)("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"Adicione alguns produtos incr\xedveis ao seu carrinho e aproveite nossos pre\xe7os especiais de atacado."}),(0,r.jsx)("button",{onClick:()=>{e.push("/")},className:"bg-primary-500 text-black px-8 py-3 rounded-lg font-semibold hover:bg-primary-400 transition-colors duration-200",children:"Continuar Comprando"})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,r.jsx)("div",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center text-gray-300 hover:text-white",children:[(0,r.jsx)(l.Z,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("span",{className:"font-medium",children:"Carrinho"})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-400",children:[f()," ",1===f()?"item":"itens"]})]})}),(0,r.jsx)("div",{className:"bg-gray-800",children:a.map((e,t)=>{let a=A(e.product,e.quantity);return(0,r.jsx)("div",{className:"border-b border-gray-700 p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("img",{src:e.product.image,alt:e.product.name,className:"h-20 w-20 object-cover rounded-lg"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium text-white text-sm leading-tight",children:e.product.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.selectedSize," • ",e.selectedColor||"Cor padr\xe3o"]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"2-5 Dias \xfateis ap\xf3s a confirma\xe7\xe3o do pagamento"})]}),(0,r.jsx)("button",{onClick:()=>x(e.product.id,e.selectedSize,e.selectedColor),className:"ml-2 p-1 text-gray-400 hover:text-red-400",children:(0,r.jsx)(o.Z,{size:16})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>g(e.product.id,e.selectedSize,e.quantity-1,e.selectedColor),className:"w-8 h-8 flex items-center justify-center border border-gray-600 rounded-full hover:bg-gray-700",children:(0,r.jsx)(d,{size:14})}),(0,r.jsx)("span",{className:"w-8 text-center text-sm font-medium",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>g(e.product.id,e.selectedSize,e.quantity+1,e.selectedColor),className:"w-8 h-8 flex items-center justify-center border border-gray-600 rounded-full hover:bg-gray-700",children:(0,r.jsx)(u.Z,{size:14})})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-sm font-semibold text-white",children:["R$ ",(a.discountedPrice*e.quantity).toFixed(2).replace(".",",")]}),a.discountPercentage>0&&(0,r.jsxs)("div",{className:"text-xs text-green-600",children:["Economia: R$ ",a.savings.toFixed(2).replace(".",",")]})]})]})]})]})},"".concat(e.product.id,"-").concat(e.selectedSize,"-").concat(e.selectedColor||"default"))})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(j,{products:a.map(e=>({category:e.product.category,value:N(e.product,e.quantity),quantity:e.quantity})),totalPieces:y(),onShippingSelect:Y})}),(0,r.jsxs)("div",{className:"bg-gray-800 mt-4 p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-white mb-3",children:"Cupom de desconto"}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("input",{type:"text",placeholder:"Digite o cupom de desconto",value:O,onChange:e=>U(e.target.value),className:"flex-1 px-3 py-2 border border-gray-600 rounded-lg text-sm bg-gray-700 text-white placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,r.jsx)("button",{onClick:()=>{let e={DESCONTO10:10,ATACADO15:15,PRIMEIRA20:20,FREEGRATIS:0};void 0!==e[O.toUpperCase()]?($(e[O.toUpperCase()]),B(O.toUpperCase()),U(""),alert("Cupom ".concat(O.toUpperCase()," aplicado com sucesso!"))):alert("Cupom inv\xe1lido")},className:"bg-primary-500 text-black px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-400 transition-colors duration-200",children:"Aplicar"})]}),J&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["Cupom ",J," aplicado!","FREEGRATIS"===J?" Frete gr\xe1tis!":" ".concat(G,"% de desconto!")]})]}),(0,r.jsxs)("div",{className:"bg-gray-800 mt-4 p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-white mb-3",children:"Resumo do Pedido"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{children:["Subtotal (",f()," itens)"]}),(0,r.jsxs)("span",{children:["R$ ",v().toFixed(2).replace(".",",")]})]}),J&&(0,r.jsxs)("div",{className:"flex justify-between text-sm text-green-600",children:[(0,r.jsxs)("span",{children:["Desconto (",J,")"]}),(0,r.jsx)("span",{children:"FREEGRATIS"===J?"-R$ ".concat(C().toFixed(2).replace(".",",")):"-".concat(G,"%")})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:"Frete"}),(0,r.jsx)("span",{children:X?"FREEGRATIS"===J?"Gr\xe1tis":"R$ ".concat(X.price.toFixed(2).replace(".",",")):"FREEGRATIS"===J?"Gr\xe1tis":"R$ ".concat(C().toFixed(2).replace(".",","))})]}),ee()>0&&(0,r.jsxs)("div",{className:"flex justify-between text-sm text-green-600 bg-green-50 p-2 rounded",children:[(0,r.jsx)("span",{className:"font-medium",children:"\uD83D\uDCB0 Economia Total"}),(0,r.jsxs)("span",{className:"font-medium",children:["R$ ",ee().toFixed(2).replace(".",",")]})]}),(0,r.jsx)("div",{className:"border-t border-gray-600 pt-3 mt-3",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-lg font-semibold text-white",children:"Total a pagar:"}),(0,r.jsxs)("span",{className:"text-xl font-bold text-primary-400",children:["R$ ",K().toFixed(2).replace(".",",")]})]})})]})]}),(0,r.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Total a pagar:"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-white",children:["R$ ",K().toFixed(2).replace(".",",")]})]}),(0,r.jsxs)("button",{onClick:et,disabled:I,className:"w-full bg-primary-500 text-black py-4 px-6 rounded-lg font-semibold text-lg hover:bg-primary-400 transition-colors duration-200 flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[I?(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-black",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsx)(m.Z,{size:20}),"Fechar pedido"]})]}),(0,r.jsx)("div",{className:"h-24"})]})}},6281:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return n},a:function(){return o}});var r=a(7437),s=a(2265),i=a(9203);let l=(0,s.createContext)(void 0);function n(e){let{children:t}=e,[a,n]=(0,s.useState)(null),[o,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!0),p=(0,i.e)();(0,s.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await p.auth.getSession();u(t),n(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null),(null==t?void 0:t.user)&&await x(t.user.id),h(!1)})();let{data:{subscription:e}}=p.auth.onAuthStateChange(async(e,t)=>{var a;u(t),n(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),(null==t?void 0:t.user)?await x(t.user.id):c(null),h(!1)});return()=>e.unsubscribe()},[]);let x=async e=>{try{let{data:t,error:r}=await p.from("profiles").select("*").eq("id",e).single();if(r){console.error("Erro ao buscar perfil:",r),console.log("Tentando criar perfil para usu\xe1rio:",e);let{data:t,error:s}=await p.from("profiles").insert({id:e,email:(null==a?void 0:a.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",user_type:"cliente"}).select().single();if(s){console.error("Erro ao criar perfil:",s);let t={id:e,email:(null==a?void 0:a.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c(t)}else console.log("Perfil criado com sucesso:",t),c(t)}else console.log("Perfil encontrado:",t),c(t);let{data:s,error:i}=await p.from("user_roles").select("role").eq("user_id",e);if(i){console.error("Erro ao buscar roles:",i),c(t);return}let l=t.user_type||"cliente";if(s&&s.length>0){let e=s.map(e=>e.role);e.includes("admin")?l="admin":e.includes("vendedor")&&(l="vendedor")}"00000000-0000-0000-0000-000000000001"===e&&(l="admin",console.log("\uD83D\uDD27 Usu\xe1rio admin detectado via fallback"));let n={...t,user_type:l};c(n)}catch(t){console.error("Erro ao buscar perfil:",t),c({id:e,email:"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}},g=async(e,t,a)=>{try{let{data:r}=await p.auth.getUser(),{data:s}=await p.from("profiles").select("email").eq("email",e).single();if(s)return{error:{message:"Este email j\xe1 est\xe1 cadastrado"}};if(a.cpf){let{data:e}=await p.from("profiles").select("cpf").eq("cpf",a.cpf).single();if(e)return{error:{message:"Este CPF j\xe1 est\xe1 cadastrado"}}}console.log("Criando usu\xe1rio no Supabase Auth...");let{data:i,error:l}=await p.auth.signUp({email:e,password:t,options:{data:{full_name:a.full_name,phone:a.phone}}});if(console.log("Resultado da cria\xe7\xe3o do usu\xe1rio:",{data:i,error:l}),l){let e=l.message;return l.message.includes("already registered")||l.message.includes("User already registered")?e="Este email j\xe1 est\xe1 cadastrado":l.message.includes("Invalid email")?e="Email inv\xe1lido":l.message.includes("Password should be at least")?e="A senha deve ter pelo menos 6 caracteres":l.message.includes("Unable to validate email address")&&(e="N\xe3o foi poss\xedvel validar o email"),{error:{...l,message:e}}}if(i.user){console.log("Criando perfil para usu\xe1rio:",i.user.id),console.log("Dados do perfil:",{id:i.user.id,email:i.user.email,full_name:a.full_name,phone:a.phone,cpf:a.cpf,birth_date:a.birth_date,user_type:"cliente"});let{data:e,error:t}=await p.from("profiles").insert({id:i.user.id,email:i.user.email,full_name:a.full_name,phone:a.phone,cpf:a.cpf,birth_date:a.birth_date,user_type:"cliente"}).select();if(t)return console.error("Erro ao criar perfil:",t),console.error("Detalhes do erro:",{code:t.code,message:t.message,details:t.details,hint:t.hint}),await p.auth.admin.deleteUser(i.user.id),{error:{message:"Erro ao criar perfil do usu\xe1rio"}};console.log("Perfil criado com sucesso:",e)}return console.log("Cadastro finalizado com sucesso, retornando sucesso"),{error:null}}catch(e){return console.error("Erro no signUp:",e),{error:{message:"Erro interno do servidor"}}}},f=async(e,t)=>{try{var a;console.log("Tentando fazer login para:",e);let{data:r,error:s}=await p.auth.signInWithPassword({email:e,password:t});if(s)return console.error("Erro no login:",s),{error:s};return console.log("Login realizado com sucesso:",null===(a=r.user)||void 0===a?void 0:a.email),{error:null}}catch(e){return console.error("Erro no catch do login:",e),{error:e}}},y=async()=>{try{await p.auth.signOut()}catch(e){console.error("Erro ao fazer logout:",e)}},v=async e=>{if(!a)return{error:Error("Usu\xe1rio n\xe3o autenticado")};try{let{error:t}=await p.from("profiles").update(e).eq("id",a.id);if(t)return{error:t};return c(t=>t?{...t,...e}:null),{error:null}}catch(e){return{error:e}}};return(0,r.jsx)(l.Provider,{value:{user:a,profile:o,session:d,loading:m,signUp:g,signIn:f,signOut:y,updateProfile:v},children:t})}function o(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1723:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2718:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},4794:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6275:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},340:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"notFound")&&a.d(t,{notFound:function(){return r.notFound}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[99,882,527,971,117,744],function(){return e(e.s=78)}),_N_E=e.O()}]);