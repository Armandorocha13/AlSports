(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{1154:function(e,r,t){Promise.resolve().then(t.bind(t,6873))},6873:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return h}});var s=t(7437),a=t(2265),l=t(9376),o=t(7648),n=t(9345),i=t(6337),c=t(7769),u=t(2208),d=t(2660),m=t(6281);function f(){let[e,r]=(0,a.useState)(""),[t,f]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),[x,g]=(0,a.useState)(!1),[y,v]=(0,a.useState)(""),{signIn:b}=(0,m.a)(),j=(0,l.useRouter)(),w=(0,l.useSearchParams)().get("redirectTo")||"/",N=async r=>{r.preventDefault(),g(!0),v("");let{error:s}=await b(e,t);s?(console.error("Erro no login:",s),v(s.message),g(!1)):(console.log("Login realizado com sucesso, redirecionando para:",w),j.push(w))};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(o.default,{href:"/",className:"flex items-center",children:(0,s.jsx)("div",{className:"w-12 h-12 bg-primary-500 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"font-bold text-black text-lg",children:"AL"})})})}),(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-bold text-white",children:"Entre na sua conta"}),(0,s.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-300",children:["Ou"," ",(0,s.jsx)(o.default,{href:"/auth/register",className:"font-medium text-primary-400 hover:text-primary-300",children:"crie uma nova conta"})]})]}),(0,s.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,s.jsxs)("div",{className:"bg-gray-800 py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[(0,s.jsxs)("form",{className:"space-y-6",onSubmit:N,children:[y&&(0,s.jsx)("div",{className:"bg-red-900 border border-red-700 text-red-200 px-4 py-3 rounded-md text-sm",children:y}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),(0,s.jsxs)("div",{className:"mt-1 relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(n.Z,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>r(e.target.value),className:"appearance-none block w-full pl-10 pr-3 py-2 bg-gray-700 border border-gray-600 text-white rounded-md placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"seu@email.com"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300",children:"Senha"}),(0,s.jsxs)("div",{className:"mt-1 relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(i.Z,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{id:"password",name:"password",type:h?"text":"password",autoComplete:"current-password",required:!0,value:t,onChange:e=>f(e.target.value),className:"appearance-none block w-full pl-10 pr-10 py-2 bg-gray-700 border border-gray-600 text-white rounded-md placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Sua senha"}),(0,s.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>p(!h),children:h?(0,s.jsx)(c.Z,{className:"h-5 w-5 text-gray-400"}):(0,s.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-300",children:"Lembrar de mim"})]}),(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsx)(o.default,{href:"/auth/forgot-password",className:"font-medium text-primary-400 hover:text-primary-300",children:"Esqueceu sua senha?"})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-black bg-primary-500 hover:bg-primary-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Entrando...":"Entrar"})})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,s.jsx)("span",{className:"px-2 bg-gray-800 text-gray-400",children:"Ou continue com"})})]}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{className:"w-full inline-flex justify-center py-2 px-4 border border-gray-600 rounded-md shadow-sm bg-gray-700 text-sm font-medium text-gray-300 hover:bg-gray-600",children:[(0,s.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,s.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,s.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,s.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),(0,s.jsx)("span",{className:"ml-2",children:"Google"})]}),(0,s.jsxs)("button",{className:"w-full inline-flex justify-center py-2 px-4 border border-gray-600 rounded-md shadow-sm bg-gray-700 text-sm font-medium text-gray-300 hover:bg-gray-600",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),(0,s.jsx)("span",{className:"ml-2",children:"Facebook"})]})]})]})]})}),(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsxs)(o.default,{href:"/",className:"inline-flex items-center text-sm text-gray-300 hover:text-white",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-1"}),"Voltar para o site"]})})]})}function h(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Carregando..."}),children:(0,s.jsx)(f,{})})}},6281:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return n},a:function(){return i}});var s=t(7437),a=t(2265),l=t(9203);let o=(0,a.createContext)(void 0);function n(e){let{children:r}=e,[t,n]=(0,a.useState)(null),[i,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(null),[m,f]=(0,a.useState)(!0),h=(0,l.e)();(0,a.useEffect)(()=>{(async()=>{var e;let{data:{session:r}}=await h.auth.getSession();d(r),n(null!==(e=null==r?void 0:r.user)&&void 0!==e?e:null),(null==r?void 0:r.user)&&await p(r.user.id),f(!1)})();let{data:{subscription:e}}=h.auth.onAuthStateChange(async(e,r)=>{var t;d(r),n(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),(null==r?void 0:r.user)?await p(r.user.id):c(null),f(!1)});return()=>e.unsubscribe()},[]);let p=async e=>{try{let{data:r,error:s}=await h.from("profiles").select("*").eq("id",e).single();if(s){console.error("Erro ao buscar perfil:",s),console.log("Tentando criar perfil para usu\xe1rio:",e);let{data:r,error:a}=await h.from("profiles").insert({id:e,email:(null==t?void 0:t.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",user_type:"cliente"}).select().single();if(a){console.error("Erro ao criar perfil:",a);let r={id:e,email:(null==t?void 0:t.email)||"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c(r)}else console.log("Perfil criado com sucesso:",r),c(r)}else console.log("Perfil encontrado:",r),c(r);let{data:a,error:l}=await h.from("user_roles").select("role").eq("user_id",e);if(l){console.error("Erro ao buscar roles:",l),c(r);return}let o=r.user_type||"cliente";if(a&&a.length>0){let e=a.map(e=>e.role);e.includes("admin")?o="admin":e.includes("vendedor")&&(o="vendedor")}"00000000-0000-0000-0000-000000000001"===e&&(o="admin",console.log("\uD83D\uDD27 Usu\xe1rio admin detectado via fallback"));let n={...r,user_type:o};c(n)}catch(r){console.error("Erro ao buscar perfil:",r),c({id:e,email:"usuario@exemplo.com",full_name:"Usu\xe1rio",phone:null,cpf:null,birth_date:null,user_type:"cliente",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}},x=async(e,r,t)=>{try{let{data:s}=await h.auth.getUser(),{data:a}=await h.from("profiles").select("email").eq("email",e).single();if(a)return{error:{message:"Este email j\xe1 est\xe1 cadastrado"}};if(t.cpf){let{data:e}=await h.from("profiles").select("cpf").eq("cpf",t.cpf).single();if(e)return{error:{message:"Este CPF j\xe1 est\xe1 cadastrado"}}}console.log("Criando usu\xe1rio no Supabase Auth...");let{data:l,error:o}=await h.auth.signUp({email:e,password:r,options:{data:{full_name:t.full_name,phone:t.phone}}});if(console.log("Resultado da cria\xe7\xe3o do usu\xe1rio:",{data:l,error:o}),o){let e=o.message;return o.message.includes("already registered")||o.message.includes("User already registered")?e="Este email j\xe1 est\xe1 cadastrado":o.message.includes("Invalid email")?e="Email inv\xe1lido":o.message.includes("Password should be at least")?e="A senha deve ter pelo menos 6 caracteres":o.message.includes("Unable to validate email address")&&(e="N\xe3o foi poss\xedvel validar o email"),{error:{...o,message:e}}}if(l.user){console.log("Criando perfil para usu\xe1rio:",l.user.id),console.log("Dados do perfil:",{id:l.user.id,email:l.user.email,full_name:t.full_name,phone:t.phone,cpf:t.cpf,birth_date:t.birth_date,user_type:"cliente"});let{data:e,error:r}=await h.from("profiles").insert({id:l.user.id,email:l.user.email,full_name:t.full_name,phone:t.phone,cpf:t.cpf,birth_date:t.birth_date,user_type:"cliente"}).select();if(r)return console.error("Erro ao criar perfil:",r),console.error("Detalhes do erro:",{code:r.code,message:r.message,details:r.details,hint:r.hint}),await h.auth.admin.deleteUser(l.user.id),{error:{message:"Erro ao criar perfil do usu\xe1rio"}};console.log("Perfil criado com sucesso:",e)}return console.log("Cadastro finalizado com sucesso, retornando sucesso"),{error:null}}catch(e){return console.error("Erro no signUp:",e),{error:{message:"Erro interno do servidor"}}}},g=async(e,r)=>{try{var t;console.log("Tentando fazer login para:",e);let{data:s,error:a}=await h.auth.signInWithPassword({email:e,password:r});if(a)return console.error("Erro no login:",a),{error:a};return console.log("Login realizado com sucesso:",null===(t=s.user)||void 0===t?void 0:t.email),{error:null}}catch(e){return console.error("Erro no catch do login:",e),{error:e}}},y=async()=>{try{await h.auth.signOut()}catch(e){console.error("Erro ao fazer logout:",e)}},v=async e=>{if(!t)return{error:Error("Usu\xe1rio n\xe3o autenticado")};try{let{error:r}=await h.from("profiles").update(e).eq("id",t.id);if(r)return{error:r};return c(r=>r?{...r,...e}:null),{error:null}}catch(e){return{error:e}}};return(0,s.jsx)(o.Provider,{value:{user:t,profile:i,session:u,loading:m,signUp:x,signIn:g,signOut:y,updateProfile:v},children:r})}function i(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth deve ser usado dentro de um AuthProvider");return e}},9203:function(e,r,t){"use strict";t.d(r,{e:function(){return a}});var s=t(7272);function a(){return(0,s.createBrowserClient)("https://nzrzgtwhgousnnvxjyhf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56cnpndHdoZ291c25udnhqeWhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk2ODc1OTAsImV4cCI6MjA3NTI2MzU5MH0.RxeZfgwMfUAr6iGDCb4gsB_lDLYYgyWj70hCaC3CE7o")}},2660:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7769:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2208:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6337:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9345:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},7648:function(e,r,t){"use strict";t.d(r,{default:function(){return a.a}});var s=t(2972),a=t.n(s)},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"notFound")&&t.d(r,{notFound:function(){return s.notFound}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[972,99,971,117,744],function(){return e(e.s=1154)}),_N_E=e.O()}]);